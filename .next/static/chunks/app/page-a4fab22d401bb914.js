(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{296:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var n=o(5155),a=o(2115),r=o(740),s=o(7815),d=o(1464);let l=()=>{let[e,t]=(0,a.useState)({}),[o,l]=(0,a.useState)(!1),[i,c]=(0,a.useState)(null),[p,u]=(0,a.useState)(null),[x,m]=(0,a.useState)("");(0,a.useEffect)(()=>{let e="INDR81",o="TXN".concat(Date.now()).concat(Math.random().toString(36).substring(2,7));console.log("Client Code:",e),console.log("Client Txn Id:",o),t({clientCode:e,transUserName:"indrajeet@mudrape.com",transUserPassword:"INDR81_SP23390",authKey:"doJx8Ihyb2s/sh1pbYEDfa6JdsogEYMXKEoPF/BEwrg=",authIV:"iw/0vT01OWRph/rQplst/W7k423JXrgo4xBn3gXPsIDXTTXE461f4V4QYKGQ8wTe",payerName:"Anand Kumar Shaw",payerEmail:"anand.kumar@sabpaisa.in",payerMobile:"6291312929",amount:"1",amountType:"INR",clientTxnId:o,channelId:"npm",udf1:"",udf2:"",udf3:"",udf4:"",udf5:"",udf6:"",udf7:"",udf8:"",udf9:"",udf10:"",udf11:"",udf12:"",udf13:"",udf14:"",udf15:"",udf16:"",udf17:"",udf18:"",udf19:"",udf20:"",payerVpa:"",modeTransfer:"",byPassFlag:"",cardHolderName:"",pan:"",cardExpMonth:"",cardExpYear:"",cardType:"",cvv:"",browserDetails:"",bankId:"",env:"PROD",callbackUrl:"https://agentmudrape.com/api/payment/callback"})},[]);let f=e=>{let{name:o,value:n}=e.target;t(e=>({...e,[o]:n}))},y=async t=>{t.preventDefault(),l(!0),c(null),u("pending"),m("Initializing payment...");try{if(!e.payerName||!e.payerEmail||!e.payerMobile||!e.userId)throw Error("Please fill all required fields including User ID");if(!e.amount||0>=parseFloat(e.amount))throw Error("Please enter a valid amount");console.log("[SAVING INITIAL TRANSACTION]",e.clientTxnId);try{let t={txnId:e.clientTxnId,referenceId:e.clientTxnId,amount:parseFloat(e.amount),status:e.status,statusCode:e.statusCode,responseMessage:"Payment initiated",userId:e.userId,type:"PAYMENT",description:"Payment initiated",payerName:e.payerName,payerMobile:e.payerMobile,payerEmail:e.payerEmail,metadata:{clientCode:e.clientCode,clientTxnId:e.clientTxnId,amount:e.amount,amountType:e.amountType,userId:e.userId,initiatedAt:new Date().toISOString()},createdAt:new Date().toISOString()};await (0,s.r)(t),console.log("[TRANSACTION SAVED]",t)}catch(e){console.warn("[FAILED TO SAVE INITIAL TRANSACTION]",e)}m("Redirecting to payment gateway..."),console.log("[REDIRECTING TO SABPAISA]",e),(0,r.j)(e),setTimeout(()=>{l(!1)},3e3)}catch(e){console.error("[PAYMENT INITIATION ERROR]",e),c(e.message||"Failed to initialize payment"),u("cancelled"),m("Failed to initialize payment"),l(!1)}};return e.clientCode?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{padding:"20px",textAlign:"center",backgroundColor:"#f5f5f5",borderBottom:"2px solid #ddd"},children:[(0,n.jsx)("h1",{style:{margin:"0 0 10px 0"},children:"SabPaisa Payment Integration"}),(0,n.jsxs)("div",{style:{marginTop:"10px"},children:[(0,n.jsx)("a",{href:"/transactions",style:{margin:"0 10px",padding:"10px 20px",backgroundColor:"#007bff",color:"white",textDecoration:"none",borderRadius:"5px",display:"inline-block"},children:"View Transactions"}),(0,n.jsx)("a",{href:"/response",style:{margin:"0 10px",padding:"10px 20px",backgroundColor:"#28a745",color:"white",textDecoration:"none",borderRadius:"5px",display:"inline-block"},children:"Payment Response"})]})]}),p&&(0,n.jsx)("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"},children:(0,n.jsx)(d.A,{status:p,message:x})}),(0,n.jsxs)("form",{onSubmit:y,style:{padding:"20px",maxWidth:"600px",margin:"20px auto",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},autoComplete:"off",children:[(0,n.jsx)("h2",{style:{marginTop:0,marginBottom:"20px",color:"#333"},children:"Payment Details"}),(0,n.jsxs)("div",{style:{backgroundColor:"#f0f8ff",padding:"15px",borderRadius:"5px",marginBottom:"20px",border:"1px solid #b3d9ff"},children:[(0,n.jsx)("h3",{style:{marginTop:0,color:"#0066cc"},children:"Required Information"}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsxs)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:["Payer Name ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"text",name:"payerName",value:e.payerName||"",onChange:f,required:!0,style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsxs)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:["Payer Email ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"email",name:"payerEmail",value:e.payerEmail||"",onChange:f,required:!0,style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsxs)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:["Payer Mobile ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"tel",name:"payerMobile",value:e.payerMobile||"",onChange:f,required:!0,pattern:"[0-9]{10}",style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsxs)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:["Amount (INR) ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"number",name:"amount",value:e.amount||"",onChange:f,required:!0,min:"1",step:"0.01",style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsxs)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:["User ID ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"text",name:"userId",value:e.userId||"",onChange:f,required:!0,placeholder:"Enter User ID for Site B",style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:"Transaction ID"}),(0,n.jsx)("input",{type:"text",name:"clientTxnId",value:e.clientTxnId||"",onChange:f,readOnly:!0,style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ccc",backgroundColor:"#f5f5f5"},autoComplete:"off"})]})]}),(0,n.jsxs)("details",{style:{marginBottom:"20px"},children:[(0,n.jsx)("summary",{style:{cursor:"pointer",fontWeight:"bold",padding:"10px",backgroundColor:"#f5f5f5",borderRadius:"4px"},children:"Advanced Settings (Optional)"}),(0,n.jsx)("div",{style:{marginTop:"10px",padding:"10px"},children:Object.keys(e).filter(e=>!["payerName","payerEmail","payerMobile","amount","clientTxnId","userId"].includes(e)).map(t=>{var o;return(0,n.jsxs)("div",{style:{marginBottom:10},children:[(0,n.jsx)("label",{style:{display:"block",fontWeight:"bold",fontSize:"12px",color:"#666"},children:t}),(0,n.jsx)("input",{type:"text",name:t,value:null!=(o=e[t])?o:"",onChange:f,style:{width:"100%",padding:"6px",fontSize:"12px",borderRadius:"4px",border:"1px solid #ddd"},autoComplete:"off"})]},t)})})]}),i&&(0,n.jsxs)("div",{style:{marginBottom:"15px",padding:"12px",backgroundColor:"#ffebee",border:"1px solid #f44336",borderRadius:"5px",color:"#c62828"},children:[(0,n.jsx)("strong",{children:"⚠️ Error:"})," ",i]}),(0,n.jsx)("button",{type:"submit",disabled:o,style:{width:"100%",padding:"15px 20px",backgroundColor:o?"#ccc":"#0070f3",color:"white",border:"none",borderRadius:"5px",cursor:o?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold",transition:"background-color 0.3s"},onMouseOver:e=>!o&&(e.target.style.backgroundColor="#0051cc"),onMouseOut:e=>!o&&(e.target.style.backgroundColor="#0070f3"),children:o?"⏳ Processing...":"\uD83D\uDCB3 Proceed to Pay"}),(0,n.jsx)("p",{style:{marginTop:"15px",fontSize:"12px",color:"#666",textAlign:"center"},children:"\uD83D\uDD12 Your payment is secure and encrypted"})]})]}):(0,n.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:(0,n.jsx)("p",{children:"Loading payment form..."})})}},1464:(e,t,o)=>{"use strict";o.d(t,{A:()=>d});var n=o(5155),a=o(9137),r=o.n(a),s=o(2115);let d=e=>{let{status:t,message:o,onStatusChange:a}=e,[d,l]=(0,s.useState)(t||"pending"),[i,c]=(0,s.useState)(o||"");(0,s.useEffect)(()=>{t&&l(t)},[t]),(0,s.useEffect)(()=>{o&&c(o)},[o]);let p=(e=>{switch(e.toLowerCase()){case"success":case"completed":case"paid":return{color:"#4caf50",backgroundColor:"#e8f5e8",borderColor:"#4caf50",icon:"✅",text:"Payment Successful",message:i||"Your payment has been processed successfully!"};case"cancelled":case"canceled":case"failed":case"error":return{color:"#f44336",backgroundColor:"#ffebee",borderColor:"#f44336",icon:"❌",text:"Payment Failed",message:i||"Payment was cancelled or failed. Please try again."};case"pending":case"processing":case"in_progress":return{color:"#ff9800",backgroundColor:"#fff3e0",borderColor:"#ff9800",icon:"⏳",text:"Payment Pending",message:i||"Your payment is being processed. Please wait..."};default:return{color:"#9e9e9e",backgroundColor:"#f5f5f5",borderColor:"#9e9e9e",icon:"❓",text:"Unknown Status",message:i||"Payment status is unknown."}}})(d);return(0,n.jsxs)("div",{style:{padding:"20px",margin:"20px 0",borderRadius:"8px",border:"2px solid ".concat(p.borderColor),backgroundColor:p.backgroundColor,textAlign:"center",fontFamily:"Arial, sans-serif"},className:"jsx-d732791046adfab6",children:[(0,n.jsx)("div",{style:{fontSize:"48px",marginBottom:"10px"},className:"jsx-d732791046adfab6",children:p.icon}),(0,n.jsx)("h2",{style:{color:p.color,margin:"0 0 10px 0",fontSize:"24px",fontWeight:"bold"},className:"jsx-d732791046adfab6",children:p.text}),(0,n.jsx)("p",{style:{color:p.color,margin:"0 0 15px 0",fontSize:"16px",lineHeight:"1.4"},className:"jsx-d732791046adfab6",children:p.message}),"pending"===d&&(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"15px"},className:"jsx-d732791046adfab6",children:[(0,n.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid ".concat(p.color),borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite",marginRight:"10px"},className:"jsx-d732791046adfab6"}),(0,n.jsx)("span",{style:{color:p.color,fontSize:"14px"},className:"jsx-d732791046adfab6",children:"Processing..."})]}),(0,n.jsx)(r(),{id:"d732791046adfab6",children:"@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}"})]})}},6937:(e,t,o)=>{Promise.resolve().then(o.bind(o,296))},7815:(e,t,o)=>{"use strict";o.d(t,{r:()=>a}),o(7936),o(9509);let n=["referenceId","amount","type","description","metadata","createdAt"];async function a(e){let t;for(let t of n)if(!(t in e))throw Error("Missing field: ".concat(t));let o={"Content-Type":"application/json"};o.Authorization="Bearer ".concat("my-client-token");let a=await fetch("/api/transactions",{method:"POST",headers:o,body:JSON.stringify(e),cache:"no-store"}),r=await a.text();try{t=r?JSON.parse(r):null}catch(e){t={raw:r}}if(!a.ok){let e=Error("Proxy error: ".concat(a.status," - ").concat((null==t?void 0:t.error)||r));throw e.status=a.status,e.data=t,console.error("API route error:",{status:a.status,text:r,parsed:t}),e}return t}},7936:()=>{throw Error('Module build failed: UnhandledSchemeError: Reading from "node:crypto" is not handled by plugins (Unhandled scheme).\nWebpack supports "data:" and "file:" URIs by default.\nYou may need an additional plugin to handle "node:" URIs.\n    at C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:29:408351\n    at Hook.eval [as callAsync] (eval at create (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:14:9224), <anonymous>:6:1)\n    at Hook.CALL_ASYNC_DELEGATE [as _callAsync] (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:14:6378)\n    at Object.processResource (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:29:408276)\n    at processResource (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\loader-runner\\LoaderRunner.js:1:5308)\n    at iteratePitchingLoaders (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\loader-runner\\LoaderRunner.js:1:4667)\n    at runLoaders (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\loader-runner\\LoaderRunner.js:1:8590)\n    at NormalModule._doBuild (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:29:408138)\n    at NormalModule.build (C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:29:410151)\n    at C:\\Users\\techs\\Downloads\\nextjs_1 (2)\\nextjs_1\\node_modules\\next\\dist\\compiled\\webpack\\bundle5.js:29:82479')}},e=>{e.O(0,[359,441,964,358],()=>e(e.s=6937)),_N_E=e.O()}]);